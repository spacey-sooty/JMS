{"ast":null,"code":"import _objectSpread from\"/home/spacey_sooty/Documents/projects/JMS/jms-frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _objectWithoutProperties from\"/home/spacey_sooty/Documents/projects/JMS/jms-frontend/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";import _classCallCheck from\"/home/spacey_sooty/Documents/projects/JMS/jms-frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/home/spacey_sooty/Documents/projects/JMS/jms-frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/home/spacey_sooty/Documents/projects/JMS/jms-frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/home/spacey_sooty/Documents/projects/JMS/jms-frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";var _excluded=[\"defaultOpen\"];import React from\"react\";import{Accordion}from\"react-bootstrap\";import{role2id,role2string}from\"support/ws-additional\";import SimpleTooltip from\"./elements/SimpleTooltip\";import FieldPosSelector,{FieldResource}from\"./FieldPosSelector\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var ResourceRoleLabel=/*#__PURE__*/function(_React$PureComponent){_inherits(ResourceRoleLabel,_React$PureComponent);var _super=_createSuper(ResourceRoleLabel);function ResourceRoleLabel(){_classCallCheck(this,ResourceRoleLabel);return _super.apply(this,arguments);}_createClass(ResourceRoleLabel,[{key:\"renderRole\",value:function renderRole(){return role2string(this.props.role);}},{key:\"render\",value:function render(){return this.props.fta?/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"[FTA]\\xA0\"}),\" \",this.renderRole(),\" \"]}):this.renderRole();}}]);return ResourceRoleLabel;}(React.PureComponent);function getAllQuotas(status){var all=[];if(\"Quota\"in status.element){all.push(status.element.Quota);}else if(\"And\"in status.element){all=all.concat(status.element.And.flatMap(function(el){return getAllQuotas(el);}));}else if(\"Or\"in status.element){all=all.concat(status.element.Or.flatMap(function(el){return getAllQuotas(el);}));}return all;}export var ResourceRequirementMinimap=/*#__PURE__*/function(_React$PureComponent2){_inherits(ResourceRequirementMinimap,_React$PureComponent2);var _super2=_createSuper(ResourceRequirementMinimap);function ResourceRequirementMinimap(){_classCallCheck(this,ResourceRequirementMinimap);return _super2.apply(this,arguments);}_createClass(ResourceRequirementMinimap,[{key:\"render\",value:function render(){var status=this.props.status;var quotas=getAllQuotas(status);return/*#__PURE__*/_jsx(FieldPosSelector,{children:quotas.map(function(q){return/*#__PURE__*/_jsx(FieldResource,{role:q.template.role,fta:q.template.fta,children:/*#__PURE__*/_jsx(SimpleTooltip,{id:role2id(q.template.role),tip:/*#__PURE__*/_jsx(ResourceRoleLabel,{fta:q.template.fta,role:q.template.role}),children:/*#__PURE__*/_jsx(\"div\",{className:\"resource-indicator\",\"data-role\":role2id(q.template.role),\"data-fta\":q.template.fta,\"data-satisfied\":q.satisfied,\"data-ready\":q.ready,children:q.resource_ids.length})})});})});}}]);return ResourceRequirementMinimap;}(React.PureComponent);export var ResourceRequirementMinimapAccordion=/*#__PURE__*/function(_React$PureComponent3){_inherits(ResourceRequirementMinimapAccordion,_React$PureComponent3);var _super3=_createSuper(ResourceRequirementMinimapAccordion);function ResourceRequirementMinimapAccordion(){_classCallCheck(this,ResourceRequirementMinimapAccordion);return _super3.apply(this,arguments);}_createClass(ResourceRequirementMinimapAccordion,[{key:\"render\",value:function render(){var _this$props=this.props,defaultOpen=_this$props.defaultOpen,props=_objectWithoutProperties(_this$props,_excluded);return/*#__PURE__*/_jsx(Accordion,{defaultActiveKey:defaultOpen?\"0\":undefined,children:/*#__PURE__*/_jsxs(Accordion.Item,{eventKey:\"0\",children:[/*#__PURE__*/_jsx(Accordion.Header,{className:\"resource-accordion-header\",\"data-ready\":props.status.ready,children:\" Resource Allocation Map \"}),/*#__PURE__*/_jsx(Accordion.Body,{children:/*#__PURE__*/_jsx(ResourceRequirementMinimap,_objectSpread({},props))})]})});}}]);return ResourceRequirementMinimapAccordion;}(React.PureComponent);","map":{"version":3,"names":["React","Accordion","role2id","role2string","SimpleTooltip","FieldPosSelector","FieldResource","ResourceRoleLabel","props","role","fta","renderRole","PureComponent","getAllQuotas","status","all","element","push","Quota","concat","And","flatMap","el","Or","ResourceRequirementMinimap","quotas","map","q","template","satisfied","ready","resource_ids","length","ResourceRequirementMinimapAccordion","defaultOpen","undefined"],"sources":["/home/spacey_sooty/Documents/projects/JMS/jms-frontend/src/components/ResourceComponents.tsx"],"sourcesContent":["import React from \"react\";\nimport { Accordion } from \"react-bootstrap\";\nimport { capitalise } from \"support/strings\";\nimport { role2id, role2string } from \"support/ws-additional\";\nimport { MappedResourceQuota, ResourceRequirementStatus, ResourceRole } from \"ws-schema\";\nimport SimpleTooltip from \"./elements/SimpleTooltip\";\nimport FieldPosSelector, { FieldResource } from \"./FieldPosSelector\";\n\nexport class ResourceRoleLabel extends React.PureComponent<{ role: ResourceRole, fta?: boolean }> {\n  renderRole() {\n    return role2string(this.props.role)\n  }\n\n  render() {\n    return this.props.fta ? <React.Fragment><strong>[FTA]&nbsp;</strong> {this.renderRole()} </React.Fragment> : this.renderRole();\n  }\n}\n\nfunction getAllQuotas(status: ResourceRequirementStatus): MappedResourceQuota[] {\n  let all: MappedResourceQuota[] = [];\n  if (\"Quota\" in status.element) {\n    all.push(status.element.Quota);\n  } else if (\"And\" in status.element) {\n    all = all.concat(status.element.And.flatMap(el => getAllQuotas(el)))\n  } else if (\"Or\" in status.element) {\n    all = all.concat(status.element.Or.flatMap(el => getAllQuotas(el)))\n  }\n  return all;\n}\n\ntype ResourceRequirementMinimapProps = {\n  status: ResourceRequirementStatus\n};\n\nexport class ResourceRequirementMinimap extends React.PureComponent<ResourceRequirementMinimapProps> {\n  render() {\n    const { status } = this.props;\n\n    const quotas = getAllQuotas(status);\n\n    return <FieldPosSelector>\n      {\n        quotas.map(q => <FieldResource role={q.template.role} fta={q.template.fta}>\n          <SimpleTooltip id={role2id(q.template.role)} tip={ <ResourceRoleLabel fta={q.template.fta} role={q.template.role} /> }>\n            <div className=\"resource-indicator\" data-role={role2id(q.template.role)} data-fta={q.template.fta} data-satisfied={q.satisfied} data-ready={q.ready}>\n              { q.resource_ids.length }\n            </div>\n          </SimpleTooltip>\n        </FieldResource>)\n      }\n    </FieldPosSelector>\n  }\n}\n\nexport class ResourceRequirementMinimapAccordion extends React.PureComponent<{ defaultOpen?: boolean } & ResourceRequirementMinimapProps> {\n  render() {\n    const { defaultOpen, ...props } = this.props;\n\n    return <Accordion defaultActiveKey={defaultOpen ? \"0\" : undefined}>\n      <Accordion.Item eventKey=\"0\">\n        <Accordion.Header className=\"resource-accordion-header\" data-ready={props.status.ready}> Resource Allocation Map </Accordion.Header>\n        <Accordion.Body>\n          <ResourceRequirementMinimap {...props} />\n        </Accordion.Body>\n      </Accordion.Item>\n    </Accordion>\n  }\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}