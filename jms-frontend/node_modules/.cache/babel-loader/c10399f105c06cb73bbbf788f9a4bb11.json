{"ast":null,"code":"import _objectSpread from\"/home/spacey_sooty/Documents/projects/JMS/jms-frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _objectWithoutProperties from\"/home/spacey_sooty/Documents/projects/JMS/jms-frontend/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";import _classCallCheck from\"/home/spacey_sooty/Documents/projects/JMS/jms-frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/home/spacey_sooty/Documents/projects/JMS/jms-frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/home/spacey_sooty/Documents/projects/JMS/jms-frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/home/spacey_sooty/Documents/projects/JMS/jms-frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";var _excluded=[\"arenaState\",\"targetState\",\"className\"];import confirmBool from'components/elements/Confirm';import{ResourceRequirementMinimap}from'components/ResourceComponents';import React from'react';import{Button,Col,Row}from'react-bootstrap';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var MatchFlowButton=/*#__PURE__*/function(_React$PureComponent){_inherits(MatchFlowButton,_React$PureComponent);var _super=_createSuper(MatchFlowButton);function MatchFlowButton(){_classCallCheck(this,MatchFlowButton);return _super.apply(this,arguments);}_createClass(MatchFlowButton,[{key:\"render\",value:function render(){var _this$props=this.props,arenaState=_this$props.arenaState,targetState=_this$props.targetState,className=_this$props.className,props=_objectWithoutProperties(_this$props,_excluded);return/*#__PURE__*/_jsx(Button,_objectSpread({className:\"match-flow-btn \".concat(className||\"\"),\"data-target\":targetState,active:targetState!=undefined&&(arenaState===null||arenaState===void 0?void 0:arenaState.state)===targetState},props));}}]);return MatchFlowButton;}(React.PureComponent);var MatchFlow=/*#__PURE__*/function(_React$PureComponent2){_inherits(MatchFlow,_React$PureComponent2);var _super2=_createSuper(MatchFlow);function MatchFlow(){var _this;_classCallCheck(this,MatchFlow);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super2.call.apply(_super2,[this].concat(args));_this.forceArm=function(resources){confirmBool(/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-danger\",children:[\" \",/*#__PURE__*/_jsx(\"strong\",{children:\"RESOURCES ARE NOT READY\"}),\" \"]}),/*#__PURE__*/_jsxs(\"p\",{children:[\" Are you sure you want to \",/*#__PURE__*/_jsx(\"strong\",{className:\"text-danger\",children:\" ARM MATCH? \"}),\" \"]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(ResourceRequirementMinimap,{status:resources}),/*#__PURE__*/_jsx(\"br\",{})]}),{title:undefined,okText:\"Ignore Resource Requirements\",okVariant:\"hazard-red\",size:\"lg\"}).then(function(b){return b?_this.props.onSignal({MatchArm:{force:true}}):{};});};return _this;}_createClass(MatchFlow,[{key:\"render\",value:function render(){var _this2=this;var _this$props2=this.props,state=_this$props2.state,onSignal=_this$props2.onSignal,matchLoaded=_this$props2.matchLoaded,resources=_this$props2.resources,stations=_this$props2.stations,bigEstop=_this$props2.bigEstop;var teamsOk=stations.every(function(s){return s.can_arm;});var resourceOk=resources?resources.ready:true;if((state===null||state===void 0?void 0:state.state)===\"Estop\"){return/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(MatchFlowButton,{arenaState:state,variant:\"estop-reset\",onClick:function onClick(){return _this2.props.onSignal(\"EstopReset\");},children:\" Reset Emergency Stop \"})})});}return/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsxs(Col,{children:[/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(MatchFlowButton,{arenaState:state,targetState:\"Prestart\",onClick:function onClick(){return onSignal((state===null||state===void 0?void 0:state.state)==\"Prestart\"?\"PrestartUndo\":\"Prestart\");},disabled:!(matchLoaded&&((state===null||state===void 0?void 0:state.state)===\"Idle\"&&state.net_ready||(state===null||state===void 0?void 0:state.state)===\"Prestart\"&&state.net_ready)),children:(state===null||state===void 0?void 0:state.state)==\"Prestart\"?\"Revert Prestart\":\"Prestart\"})}),/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(Button,{className:\"match-flow-btn\",\"data-target\":\"MatchPreview\",variant:\"warning\",disabled:!matchLoaded,onClick:function onClick(){return _this2.props.onAudienceDisplay(\"MatchPreview\");},children:\"Match Preview\"})}),/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(MatchFlowButton,{arenaState:state,targetState:\"MatchArmed\",variant:resourceOk?\"hazard-yellow\":\"hazard-red\",onClick:function onClick(){resourceOk?_this2.props.onSignal({MatchArm:{force:false}}):_this2.forceArm(resources);},disabled:!((state===null||state===void 0?void 0:state.state)===\"Prestart\"&&state.net_ready&&teamsOk),children:\"Arm Match\"})}),/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(MatchFlowButton,{arenaState:state,targetState:\"MatchPlay\",variant:\"hazard-yellow\",onClick:function onClick(){return _this2.props.onSignal(\"MatchPlay\");},disabled:(state===null||state===void 0?void 0:state.state)!==\"MatchArmed\",children:\"Match Play\"})}),/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(MatchFlowButton,{arenaState:state,onClick:function onClick(){return _this2.props.onSignal(\"MatchCommit\");},disabled:(state===null||state===void 0?void 0:state.state)!==\"MatchComplete\",children:\"Commit Scores\"})})]}),bigEstop&&/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(MatchFlowButton,{arenaState:state,variant:\"estop\",onClick:function onClick(){return _this2.props.onSignal(\"Estop\");},children:\" EMERGENCY STOP \"})})})]})]})});}}]);return MatchFlow;}(React.PureComponent);export{MatchFlow as default};","map":{"version":3,"names":["confirmBool","ResourceRequirementMinimap","React","Button","Col","Row","MatchFlowButton","props","arenaState","targetState","className","undefined","state","PureComponent","MatchFlow","forceArm","resources","title","okText","okVariant","size","then","b","onSignal","MatchArm","force","matchLoaded","stations","bigEstop","teamsOk","every","s","can_arm","resourceOk","ready","net_ready","onAudienceDisplay"],"sources":["/home/spacey_sooty/Documents/projects/JMS/jms-frontend/src/match_control/MatchFlow.tsx"],"sourcesContent":["import confirmBool from 'components/elements/Confirm';\nimport { ResourceRequirementMinimap } from 'components/ResourceComponents';\nimport React from 'react';\nimport { Button, ButtonProps, Col, Row } from 'react-bootstrap';\nimport { SerialisedAllianceStation, ArenaMessageAudienceDisplaySet2JMS, ArenaSignal, ArenaState, ResourceRequirementStatus } from 'ws-schema';\n\nclass MatchFlowButton extends React.PureComponent<ButtonProps & { arenaState?: ArenaState, targetState?: ArenaState[\"state\"] }> {\n  render() {\n    let { arenaState, targetState, className, ...props } = this.props;\n\n    return <Button\n      className={`match-flow-btn ${className || \"\"}`}\n      data-target={targetState}\n      active={targetState != undefined && arenaState?.state === targetState}\n      {...props}\n    />\n  }\n}\n\ntype MatchFlowProps = {\n  onSignal: (signal: ArenaSignal) => void,\n  onAudienceDisplay: (display: ArenaMessageAudienceDisplaySet2JMS) => void,\n  state?: ArenaState,\n  matchLoaded: boolean,\n  bigEstop?: boolean,\n  resources?: ResourceRequirementStatus,\n  stations: SerialisedAllianceStation[],\n};\n\nexport default class MatchFlow extends React.PureComponent<MatchFlowProps> {\n  forceArm = (resources: ResourceRequirementStatus) => {\n    confirmBool(<div className=\"text-center\">\n        <h3 className=\"text-danger\"> <strong>RESOURCES ARE NOT READY</strong> </h3>\n        <p> Are you sure you want to <strong className=\"text-danger\"> ARM MATCH? </strong> </p>\n        <br />\n        <ResourceRequirementMinimap status={resources} />\n        <br />\n      </div>,\n      { title: undefined, okText: \"Ignore Resource Requirements\", okVariant: \"hazard-red\", size: \"lg\" }\n    ).then(b => b ? this.props.onSignal({ MatchArm: { force: true } }) : {});\n  }\n\n  render() {\n    let { state, onSignal, matchLoaded, resources, stations, bigEstop } = this.props;\n    const teamsOk = stations.every(s => s.can_arm);\n    const resourceOk = resources ? resources.ready : true;\n\n    if (state?.state === \"Estop\") {\n      return <Row>\n        <Col>\n          <MatchFlowButton\n            arenaState={state}\n            variant=\"estop-reset\"\n            onClick={() => this.props.onSignal(\"EstopReset\")}\n          > Reset Emergency Stop </MatchFlowButton>\n        </Col>\n      </Row>\n    }\n\n    return <Row>\n      <Col>\n        <Row>\n          <Col>\n            <MatchFlowButton\n              arenaState={state}\n              targetState=\"Prestart\"\n              onClick={() => onSignal(state?.state == \"Prestart\" ? \"PrestartUndo\" : \"Prestart\")}\n              disabled={!(matchLoaded && ((state?.state === \"Idle\" && state.net_ready) || (state?.state === \"Prestart\" && state.net_ready)))}\n            >\n              { state?.state == \"Prestart\" ? \"Revert Prestart\" : \"Prestart\" }\n            </MatchFlowButton>\n          </Col>\n          <Col>\n            <Button\n              className=\"match-flow-btn\"\n              data-target=\"MatchPreview\"\n              variant=\"warning\"\n              disabled={!matchLoaded}\n              onClick={() => this.props.onAudienceDisplay(\"MatchPreview\")}\n            >\n              Match Preview\n            </Button>\n          </Col>\n          <Col>\n            <MatchFlowButton \n              arenaState={state} \n              targetState=\"MatchArmed\"\n              variant={resourceOk ? \"hazard-yellow\" : \"hazard-red\"}\n              onClick={() => {\n                resourceOk ? this.props.onSignal({ MatchArm: { force: false } }) : this.forceArm(resources!)\n              }}\n              disabled={!(state?.state === \"Prestart\" && state.net_ready && teamsOk)}\n            >\n              Arm Match\n            </MatchFlowButton>\n          </Col>\n          <Col>\n            <MatchFlowButton\n              arenaState={state}\n              targetState=\"MatchPlay\"\n              variant=\"hazard-yellow\"\n              onClick={() => this.props.onSignal(\"MatchPlay\")}\n              disabled={state?.state !== \"MatchArmed\"}\n            >\n              Match Play\n            </MatchFlowButton>\n          </Col>\n          <Col>\n            <MatchFlowButton\n              arenaState={state}\n              onClick={() => this.props.onSignal(\"MatchCommit\")}\n              disabled={state?.state !== \"MatchComplete\"}\n            >\n              Commit Scores\n            </MatchFlowButton>\n          </Col>\n        </Row>\n        {\n          bigEstop && <React.Fragment>\n            <br />\n            <Row>\n              <Col>\n                <MatchFlowButton\n                  arenaState={state}\n                  variant=\"estop\"\n                  onClick={() => this.props.onSignal(\"Estop\")}\n                > EMERGENCY STOP </MatchFlowButton>\n              </Col>\n            </Row>\n          </React.Fragment>\n        }\n      </Col>\n    </Row>\n  }\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}