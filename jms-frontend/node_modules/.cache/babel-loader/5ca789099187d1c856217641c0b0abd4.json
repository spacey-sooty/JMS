{"ast":null,"code":"import BufferedFormControl from\"components/elements/BufferedFormControl\";import{confirmModal}from\"components/elements/Confirm\";import EnumToggleGroup from\"components/elements/EnumToggleGroup\";import moment from\"moment\";import React from\"react\";import{Form}from\"react-bootstrap\";import update from\"immutability-helper\";import{nullIfEmpty}from\"support/strings\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";var ISSUE_TYPES=[\"CODE\",\"ROBORIO\",\"RADIO\",\"LAPTOP\",\"POWER\",\"CAN\",\"E-STOP\",\"E-STOP (FTA)\",\"UNSAFE\",\"OTHER\"];export default function newTicket(csa_name,team,match,on_ticket){var match_picker=Array.isArray(match);var team_picker=Array.isArray(team);confirmModal(\"\",{data:{team:team_picker?team[0]:team,match_id:match_picker?undefined:match===null||match===void 0?void 0:match.id,issue_type:\"OTHER\",author:csa_name,notes:[{author:csa_name,time:0,comment:\"\"}],resolved:false},size:\"lg\",title:\"Create Ticket\",okText:\"Submit Ticket\",renderInner:function renderInner(ticket,_onUpdate){return/*#__PURE__*/_jsxs(React.Fragment,{children:[team_picker?/*#__PURE__*/_jsx(Form.Select,{className:\"my-2\",value:ticket.team||team[0],onChange:function onChange(t){return _onUpdate(update(ticket,{team:{$set:Number(t.target.value)}}));},children:team.map(function(t){return/*#__PURE__*/_jsxs(\"option\",{value:t,children:[\"Team \",t]},t);})}):undefined,match_picker?/*#__PURE__*/_jsxs(Form.Select,{className:\"my-2\",value:ticket.match_id||\"\",onChange:function onChange(id){return _onUpdate(update(ticket,{match_id:{$set:nullIfEmpty(id.target.value)}}));},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\" No Match \"}),match.map(function(m){return/*#__PURE__*/_jsxs(\"option\",{value:m.id||\"\",children:[\" \",m.name,\" \"]},m.id);})]}):undefined,/*#__PURE__*/_jsx(EnumToggleGroup,{className:\"flex-wrap\",name:\"issue_group\",values:ISSUE_TYPES,value:ticket.issue_type,onChange:function onChange(v){return _onUpdate(update(ticket,{issue_type:{$set:v}}));},variant:\"outline-warning\",variantActive:\"danger\"}),/*#__PURE__*/_jsx(\"br\",{}),\" \",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(Form.Label,{children:\" Notes \"}),/*#__PURE__*/_jsx(BufferedFormControl,{instant:true,autofocus:true,as:\"textarea\",placeholder:\"Team lost battery on field...\",value:ticket.notes[0].comment,onUpdate:function onUpdate(v){return _onUpdate(update(ticket,{notes:{0:{comment:{$set:String(v)}}}}));}})]});}}).then(function(ticket){ticket.notes[0].time=moment().utc().unix();on_ticket(ticket);// this.props.new_ticket(ticket)\n});}","map":{"version":3,"names":["BufferedFormControl","confirmModal","EnumToggleGroup","moment","React","Form","update","nullIfEmpty","ISSUE_TYPES","newTicket","csa_name","team","match","on_ticket","match_picker","Array","isArray","team_picker","data","match_id","undefined","id","issue_type","author","notes","time","comment","resolved","size","title","okText","renderInner","ticket","onUpdate","t","$set","Number","target","value","map","m","name","v","String","then","utc","unix"],"sources":["/home/spacey_sooty/Documents/projects/JMS/jms-frontend/src/csa/NewTicket.tsx"],"sourcesContent":["import BufferedFormControl from \"components/elements/BufferedFormControl\";\nimport { confirmModal } from \"components/elements/Confirm\";\nimport EnumToggleGroup from \"components/elements/EnumToggleGroup\";\nimport moment from \"moment\";\nimport React from \"react\";\nimport { Form } from \"react-bootstrap\";\nimport { SerializedMatch, SupportTicket } from \"ws-schema\";\nimport update from \"immutability-helper\";\nimport { nullIfEmpty } from \"support/strings\";\n\nconst ISSUE_TYPES = [\n  \"CODE\",\n  \"ROBORIO\",\n  \"RADIO\",\n  \"LAPTOP\",\n  \"POWER\",\n  \"CAN\",\n  \"E-STOP\",\n  \"E-STOP (FTA)\",\n  \"UNSAFE\",\n  \"OTHER\"\n];\n\nexport default function newTicket(csa_name: string, team: number | number[], match: SerializedMatch | SerializedMatch[], on_ticket: (ticket: SupportTicket) => void) {\n  const match_picker = Array.isArray(match);\n  const team_picker = Array.isArray(team);\n\n  confirmModal(\"\", {\n    data: {\n      team: team_picker ? team[0] : team,\n      match_id: match_picker ? undefined : match?.id,\n      issue_type: \"OTHER\",\n      author: csa_name,\n      notes: [{\n        author: csa_name,\n        time: 0,\n        comment: \"\"\n      }],\n      resolved: false\n    },\n    size: \"lg\",\n    title: `Create Ticket`,\n    okText: \"Submit Ticket\",\n    renderInner: (ticket: SupportTicket, onUpdate) => <React.Fragment>\n      {\n        team_picker ? <Form.Select className=\"my-2\" value={ticket.team || team[0]} onChange={t => onUpdate(update(ticket, { team: { $set: Number(t.target.value) } }))}>\n          {\n            team.map(t => <option key={t} value={t}>Team {t}</option>)\n          }\n        </Form.Select> : undefined\n      }\n\n      {\n        match_picker ? <Form.Select className=\"my-2\" value={ticket.match_id || \"\"} onChange={id => onUpdate(update(ticket, { match_id: { $set: nullIfEmpty(id.target.value) } }))}>\n          <option value=\"\"> No Match </option>\n          {\n            match.map(m => <option key={m.id} value={m.id || \"\"}> { m.name } </option>)\n          }\n        </Form.Select> : undefined\n      }\n\n      <EnumToggleGroup\n        className=\"flex-wrap\"\n        name=\"issue_group\"\n        values={ISSUE_TYPES}\n        value={ticket.issue_type}\n        onChange={(v) => onUpdate(update(ticket, { issue_type: { $set: v } }))}\n        variant=\"outline-warning\"\n        variantActive=\"danger\"\n      />\n      <br /> <br />\n      <Form.Label> Notes </Form.Label>\n      <BufferedFormControl\n        instant\n        autofocus\n        as=\"textarea\"\n        placeholder=\"Team lost battery on field...\"\n        value={ticket.notes[0].comment}\n        onUpdate={(v) => onUpdate(update(ticket, { notes: { 0: { comment: { $set: String(v) } } } }))}\n      />\n    </React.Fragment>\n  }).then(ticket => {\n    ticket.notes[0].time = moment().utc().unix();\n    on_ticket(ticket)\n    // this.props.new_ticket(ticket)\n  })\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}