{"ast":null,"code":"import _objectSpread from\"/home/spacey_sooty/Documents/projects/JMS/jms-frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _objectWithoutProperties from\"/home/spacey_sooty/Documents/projects/JMS/jms-frontend/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";import _classCallCheck from\"/home/spacey_sooty/Documents/projects/JMS/jms-frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/home/spacey_sooty/Documents/projects/JMS/jms-frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/home/spacey_sooty/Documents/projects/JMS/jms-frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/home/spacey_sooty/Documents/projects/JMS/jms-frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";var _excluded=[\"title\",\"className\",\"children\",\"img\",\"leftChildren\",\"rightChildren\"],_excluded2=[\"options\",\"onSelect\",\"labels\",\"wrap\"];import React from\"react\";import{Button,Col,Row}from\"react-bootstrap\";import{withVal,withValU}from\"support/util\";import{role2id}from\"support/ws-additional\";import{ResourceRoleLabel}from\"./ResourceComponents\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";export var PosSelector=/*#__PURE__*/function(_React$Component){_inherits(PosSelector,_React$Component);var _super=_createSuper(PosSelector);function PosSelector(){var _this;_classCallCheck(this,PosSelector);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.imgRef=/*#__PURE__*/React.createRef();_this.colRef=/*#__PURE__*/React.createRef();_this.state={top:0,left:0,width:500,height:200,fontSize:\"1rem\"};_this.componentDidMount=function(){_this.colRef.current.addEventListener(\"resize\",function(){return _this.recalcSize();});window.addEventListener(\"resize\",function(){return _this.recalcSize();});setTimeout(function(){return _this.recalcSize();},100);setTimeout(function(){return _this.recalcSize();},500);};_this.recalcSize=function(){if(_this.colRef&&_this.imgRef){var col=_this.colRef.current;var img=_this.imgRef.current;var width=col.clientWidth;var height=col.clientHeight;var aspect=img.naturalHeight/img.naturalWidth;var hfith=width*aspect;if(height&&hfith>height){var vfitw=height/aspect;// Fit to height\n_this.setState({top:0,height:\"100%\",width:vfitw,left:(width-vfitw)/2,fontSize:\"\".concat(height/500.0,\"rem\")});}else{// Fit to width\n_this.setState({top:height?(height-hfith)/2:0,height:hfith,width:\"100%\",left:0,fontSize:\"\".concat(hfith/500.0,\"rem\")});}}};return _this;}_createClass(PosSelector,[{key:\"render\",value:function render(){var _this$props=this.props,title=_this$props.title,className=_this$props.className,children=_this$props.children,img=_this$props.img,leftChildren=_this$props.leftChildren,rightChildren=_this$props.rightChildren,props=_objectWithoutProperties(_this$props,_excluded);return/*#__PURE__*/_jsxs(Col,_objectSpread(_objectSpread({className:\"pos-selector-container \".concat(className||'')},props),{},{children:[withVal(title,function(t){return/*#__PURE__*/_jsx(Row,{className:\"pos-selector-title\",children:typeof t===\"string\"?/*#__PURE__*/_jsxs(\"h3\",{className:\"text-center mb-4\",children:[\" \",t,\" \"]}):t});}),/*#__PURE__*/_jsxs(Row,{className:\"pos-selector-row\",children:[withValU(leftChildren,function(left){return/*#__PURE__*/_jsxs(Col,{md:2,className:\"pos-selector-left\",children:[\" \",left,\" \"]});}),/*#__PURE__*/_jsx(Col,{ref:this.colRef,className:\"middle\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"pos-selector-image-container\",style:{top:this.state.top,left:this.state.left,height:this.state.height,width:this.state.width,fontSize:this.state.fontSize},children:[children,/*#__PURE__*/_jsx(\"img\",{ref:this.imgRef,width:\"100%\",height:\"100%\",className:\"pos-selector-image\",src:img})]})}),withValU(rightChildren,function(right){return/*#__PURE__*/_jsxs(Col,{md:2,className:\"pos-selector-right\",children:[\" \",right,\" \"]});})]})]}));}}]);return PosSelector;}(React.Component);export function FieldResource(props){return/*#__PURE__*/_jsx(\"div\",{className:\"field-pos-resource\",\"data-role\":role2id(props.role),\"data-fta\":props.fta,children:props.children});}export var FIELD_IMG=\"/img/game/field.png\";export default function FieldPosSelector(props){return/*#__PURE__*/_jsx(PosSelector,_objectSpread({img:FIELD_IMG,className:\"field-pos-selector \".concat(props.className||'')},props));}export function FieldResourceSelector(props){var options=props.options,onSelect=props.onSelect,labels=props.labels,wrap=props.wrap,p=_objectWithoutProperties(props,_excluded2);return/*#__PURE__*/_jsx(FieldPosSelector,_objectSpread(_objectSpread({},p),{},{children:options.map(function(r,i){return/*#__PURE__*/_jsx(FieldResource,{role:r,children:(wrap||function(r,child){return child;})(r,/*#__PURE__*/_jsx(Button,{onClick:function onClick(){return onSelect?onSelect(r):{};},children:labels?labels[i]:/*#__PURE__*/_jsx(ResourceRoleLabel,{role:r})}))},i);})}));}","map":{"version":3,"names":["React","Button","Col","Row","withVal","withValU","role2id","ResourceRoleLabel","PosSelector","imgRef","createRef","colRef","state","top","left","width","height","fontSize","componentDidMount","current","addEventListener","recalcSize","window","setTimeout","col","img","clientWidth","clientHeight","aspect","naturalHeight","naturalWidth","hfith","vfitw","setState","props","title","className","children","leftChildren","rightChildren","t","right","Component","FieldResource","role","fta","FIELD_IMG","FieldPosSelector","FieldResourceSelector","options","onSelect","labels","wrap","p","map","r","i","child"],"sources":["/home/spacey_sooty/Documents/projects/JMS/jms-frontend/src/components/FieldPosSelector.tsx"],"sourcesContent":["import React from \"react\";\nimport { Button, Col, Row } from \"react-bootstrap\";\nimport { withVal, withValU } from \"support/util\";\nimport { role2id } from \"support/ws-additional\";\nimport { ResourceRole } from \"ws-schema\";\nimport { ResourceRoleLabel } from \"./ResourceComponents\";\n\ntype PosSelectorProps = {\n  title?: React.ReactNode,\n  className?: string,\n  children?: React.ReactNode | React.ReactNode[],\n  leftChildren?: React.ReactNode | React.ReactNode[],\n  rightChildren?: React.ReactNode | React.ReactNode[],\n  img?: string,\n  pad?: number\n};\n\ntype PosSelectorState = {\n  top: number,\n  left: number,\n  width: number|string,\n  height: number|string,\n  fontSize: string\n};\n\nexport class PosSelector extends React.Component<PosSelectorProps, PosSelectorState> {\n  private imgRef = React.createRef<HTMLImageElement>();\n  private colRef = React.createRef<HTMLDivElement>();\n\n  readonly state: PosSelectorState = {\n    top: 0,\n    left: 0,\n    width: 500,\n    height: 200,\n    fontSize: \"1rem\",\n  };\n\n  componentDidMount = () => {\n    this.colRef.current!.addEventListener(\"resize\", () => this.recalcSize());\n    window.addEventListener(\"resize\", () => this.recalcSize());\n    setTimeout(() => this.recalcSize(), 100);\n    setTimeout(() => this.recalcSize(), 500);\n  }\n\n  recalcSize = () => {\n    if (this.colRef && this.imgRef) {\n      let col = this.colRef.current!;\n      let img = this.imgRef.current!;\n\n      let width = col.clientWidth;\n      let height = col.clientHeight;\n\n      let aspect = img.naturalHeight / img.naturalWidth;\n      let hfith = width * aspect;\n      \n      if (height && hfith > height) {\n        let vfitw = height / aspect;\n\n        // Fit to height\n        this.setState({\n          top: 0, height: \"100%\",\n          width: vfitw, left: (width - vfitw) / 2,\n          fontSize: `${height / 500.0}rem`\n        });\n      } else {\n        // Fit to width\n        this.setState({\n          top: (height ? (height - hfith) / 2 : 0), height: hfith,\n          width: \"100%\", left: 0,\n          fontSize: `${hfith / 500.0}rem`\n        });\n      }\n    }\n  }\n\n  render() {\n    const { title, className, children, img, leftChildren, rightChildren, ...props } = this.props;\n\n    return <Col className={`pos-selector-container ${className || ''}`} { ...props }>\n      { withVal(title, t => <Row className=\"pos-selector-title\">\n        {\n          typeof t === \"string\" ? <h3 className=\"text-center mb-4\"> {t} </h3> : t\n        }\n      </Row>) }\n\n      <Row className=\"pos-selector-row\">\n        {\n          withValU(leftChildren, left => <Col md={2} className=\"pos-selector-left\"> { left } </Col>)\n        }\n        <Col ref={this.colRef} className=\"middle\">\n          <div\n            className=\"pos-selector-image-container\"\n            style={{\n              top: this.state.top, left: this.state.left,\n              height: this.state.height, width: this.state.width,\n              fontSize: this.state.fontSize\n            }}\n          >\n            { children }\n            <img ref={this.imgRef} width=\"100%\" height=\"100%\" className=\"pos-selector-image\" src={img} />\n          </div>\n        </Col>\n        {\n          withValU(rightChildren, right => <Col md={2} className=\"pos-selector-right\"> { right } </Col>)\n        }\n      </Row>\n    </Col>\n  }\n}\n\nexport function FieldResource(props: { role: ResourceRole, fta?: boolean, children?: React.ReactNode | React.ReactNode[] }) {\n  return <div className=\"field-pos-resource\" data-role={role2id(props.role)} data-fta={props.fta}>\n    { props.children }\n  </div>\n}\n\nexport const FIELD_IMG = \"/img/game/field.png\";\n\nexport type FieldPosSelectorProps = Omit<PosSelectorProps, 'img'>;\n\nexport default function FieldPosSelector(props: Omit<PosSelectorProps, 'img'>) {\n  return <PosSelector img={FIELD_IMG} className={`field-pos-selector ${props.className || ''}`} {...props} />\n}\n\nexport type FieldResourceSelectorProps<T extends ResourceRole> = {\n  options: T[],\n  labels?: React.ReactNode[],\n  wrap?: (role: T, child: React.ReactNode) => React.ReactNode,\n  onSelect?: (role: T) => void\n} & FieldPosSelectorProps;\n\nexport function FieldResourceSelector<T extends ResourceRole>(props: FieldResourceSelectorProps<T>) {\n  const { options, onSelect, labels, wrap, ...p } = props;\n\n  return <FieldPosSelector { ...p }>\n    {\n      options.map((r, i) => (\n        <FieldResource key={i} role={r}>\n          {\n            (wrap || ((r: T, child: React.ReactNode) => child))(r, <Button onClick={() => onSelect ? onSelect(r) : {}}>\n              {\n                labels ? labels[i] : <ResourceRoleLabel role={r} />\n              }\n            </Button>)\n          }\n        </FieldResource>\n      ))\n    }\n  </FieldPosSelector>\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}