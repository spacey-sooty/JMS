{"ast":null,"code":"import _regeneratorRuntime from\"/home/spacey_sooty/Documents/projects/JMS/jms-frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/spacey_sooty/Documents/projects/JMS/jms-frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _classCallCheck from\"/home/spacey_sooty/Documents/projects/JMS/jms-frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/home/spacey_sooty/Documents/projects/JMS/jms-frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/home/spacey_sooty/Documents/projects/JMS/jms-frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/home/spacey_sooty/Documents/projects/JMS/jms-frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import{faBan,faCode,faEye,faFlag,faNetworkWired,faRobot,faUsers,faWifi}from\"@fortawesome/free-solid-svg-icons\";import{FontAwesomeIcon}from\"@fortawesome/react-fontawesome\";import confirmBool from\"components/elements/Confirm\";import React from\"react\";import{Button,Col,Row}from\"react-bootstrap\";import{withVal}from\"support/util\";import{WebsocketComponent}from\"support/ws-component\";import newTicket from\"csa/NewTicket\";import{ResourceRequirementMinimap}from\"components/ResourceComponents\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";var FieldMonitorStation=/*#__PURE__*/function(_React$PureComponent){_inherits(FieldMonitorStation,_React$PureComponent);var _super=_createSuper(FieldMonitorStation);function FieldMonitorStation(){var _this;_classCallCheck(this,FieldMonitorStation);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.triggerEstop=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var station,station_text,subtitle,result;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:station=_this.props.station;station_text=\"\".concat(station.station.alliance.toUpperCase(),\" \").concat(station.station.station);subtitle=/*#__PURE__*/_jsxs(\"h2\",{className:\"estop-subtitle\",children:[\"Are you sure you want to \",/*#__PURE__*/_jsxs(\"strong\",{className:\"text-danger\",children:[\"EMERGENCY STOP \",station_text,withVal(station.team,function(t){return\" (\".concat(t,\")\");}),\"?\"]})]});_context.next=5;return confirmBool(subtitle,{size:\"xl\",okBtn:{size:\"lg\",className:\"estop-big\",variant:\"estop\",children:\"E-STOP \".concat(station_text,\" \").concat(station.team||\"\")},cancelBtn:{size:\"lg\",className:\"btn-block\",children:\"CANCEL\",variant:\"secondary\"}});case 5:result=_context.sent;if(result){_this.props.do_estop();}case 7:case\"end\":return _context.stop();}}},_callee);}));_this.flag=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(station){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:newTicket(\"FTA\",station.team,_this.props.match.match_meta,_this.props.new_ticket);case 1:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x){return _ref2.apply(this,arguments);};}();_this.lostPktPercent=function(lost,sent){return lost/(lost+sent||1)*100;};_this.renderSent=function(lost,sent){var percent=100-_this.lostPktPercent(lost,sent);if(percent>100)return\"HI\";else if(percent<0)return\"LO\";return percent.toFixed(0);};_this.whatError=function(stn,report,estop){var _this$props$state,_this$props$match,_report$mode;var playing_match=((_this$props$state=_this.props.state)===null||_this$props$state===void 0?void 0:_this$props$state.state)===\"MatchPlay\";if(stn.bypass)return null;if(estop)return\"E-STOPPED\";if(stn.team===null)return\"NO TEAM\";if(stn.occupancy==\"Vacant\")return stn.ds_eth?\"ETH OK NO DS\":\"NO DS\";if(stn.occupancy==\"WrongMatch\")return\"WRONG MATCH\";if(stn.occupancy==\"WrongStation\")return\"WRONG STATION\";if(report==null)return\"NO DS REPORT\";if(!report.radio_ping)return\"NO RADIO\";if(!report.rio_ping)return\"NO RIO\";if(!report.robot_ping)return\"NO CODE\";if(report.rtt>100)return\"HIGH LATENCY\";if(report.battery<9)return\"LOW BATTERY\";if(playing_match&&_this.lostPktPercent(report.pkts_lost,report.pkts_sent)>10)return\"HIGH PACKET LOSS\";if(playing_match&&report.mode===null)return\"DISABLED\";if(playing_match&&report.mode!==((_this$props$match=_this.props.match)===null||_this$props$match===void 0?void 0:_this$props$match.state))return(_report$mode=report.mode)===null||_report$mode===void 0?void 0:_report$mode.toUpperCase();return null;};return _this;}_createClass(FieldMonitorStation,[{key:\"render\",value:function render(){var _s$ds_report,_s$ds_report2,_this2=this,_report$mode2,_s$ds_report3,_s$ds_report4,_s$ds_report4$rtt,_s$ds_report5,_s$ds_report6,_s$ds_report7,_s$ds_report8,_s$ds_report8$battery;var s=this.props.station;var report=s.ds_report;var estop=(report===null||report===void 0?void 0:report.estop)||s.estop||s.astop;var error=this.whatError(s,report,estop);return/*#__PURE__*/_jsxs(Row,{className:\"monitor-station\",\"data-error\":error,\"data-bypass\":s.bypass,\"data-estop\":estop,children:[/*#__PURE__*/_jsx(Col,{className:\"monitor-station-id\",md:\"auto\",children:s.station.station}),/*#__PURE__*/_jsxs(Col,{className:\"monitor-data col-full\",children:[s.bypass?/*#__PURE__*/_jsx(React.Fragment,{}):/*#__PURE__*/_jsxs(Row,{className:\"monitor-data-header\",children:[/*#__PURE__*/_jsxs(Col,{className:\"monitor-eth\",md:\"auto\",\"data-eth-ok\":s.ds_eth,children:[\" \",/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faNetworkWired}),\" \"]}),/*#__PURE__*/_jsx(Col,{className:\"monitor-occupancy\",\"data-occupancy\":s.occupancy}),/*#__PURE__*/_jsx(Col,{className:\"monitor-team\",children:s.team||\"\"}),/*#__PURE__*/_jsxs(Col,{className:\"text-end\",\"data-ok\":this.lostPktPercent((report===null||report===void 0?void 0:report.pkts_lost)||0,(report===null||report===void 0?void 0:report.pkts_sent)||0)<10,children:[this.renderSent(((_s$ds_report=s.ds_report)===null||_s$ds_report===void 0?void 0:_s$ds_report.pkts_lost)||0,((_s$ds_report2=s.ds_report)===null||_s$ds_report2===void 0?void 0:_s$ds_report2.pkts_sent)||0),\"%\"]})]}),/*#__PURE__*/_jsx(Row,{className:\"monitor-jumbo align-items-center\",\"data-error\":error,children:/*#__PURE__*/_jsx(Col,{children:s.bypass?\"BYPASS \".concat(s.team||\"\"):s.team&&this.props.mode===\"Flag\"?/*#__PURE__*/_jsx(Button,{className:\"btn-block monitor-team-btn\",variant:\"orange\",onClick:function onClick(){return _this2.flag(s);},children:\"FLAG ISSUE FOR CSA\"}):s.estop?\"E-STOPPED\":this.props.mode===\"Estop\"?/*#__PURE__*/_jsxs(Button,{className:\"btn-block monitor-team-btn\",variant:\"estop\",onClick:this.triggerEstop,children:[\" E-STOP \",s.team||\"\",\" \"]}):error?error:(report===null||report===void 0?void 0:(_report$mode2=report.mode)===null||_report$mode2===void 0?void 0:_report$mode2.toUpperCase())||\"READY\"})}),s.bypass?/*#__PURE__*/_jsx(React.Fragment,{}):/*#__PURE__*/_jsxs(Row,{className:\"monitor-indicators\",children:[/*#__PURE__*/_jsxs(Col,{\"data-ok\":(_s$ds_report3=s.ds_report)===null||_s$ds_report3===void 0?void 0:_s$ds_report3.radio_ping,md:\"4\",children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faWifi}),\" \\xA0\",(((_s$ds_report4=s.ds_report)===null||_s$ds_report4===void 0?void 0:(_s$ds_report4$rtt=_s$ds_report4.rtt)===null||_s$ds_report4$rtt===void 0?void 0:_s$ds_report4$rtt.toString())||\"---\").padStart(3,\"\\xA0\"),\"ms\"]}),/*#__PURE__*/_jsx(Col,{\"data-ok\":(_s$ds_report5=s.ds_report)===null||_s$ds_report5===void 0?void 0:_s$ds_report5.rio_ping,children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faRobot,size:\"lg\"})}),/*#__PURE__*/_jsx(Col,{\"data-ok\":(_s$ds_report6=s.ds_report)===null||_s$ds_report6===void 0?void 0:_s$ds_report6.robot_ping,children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faCode,size:\"lg\"})}),/*#__PURE__*/_jsxs(Col,{\"data-ok\":(_s$ds_report7=s.ds_report)!==null&&_s$ds_report7!==void 0&&_s$ds_report7.battery?s.ds_report.battery>9:\"\",md:\"auto\",children:[((_s$ds_report8=s.ds_report)===null||_s$ds_report8===void 0?void 0:(_s$ds_report8$battery=_s$ds_report8.battery)===null||_s$ds_report8$battery===void 0?void 0:_s$ds_report8$battery.toFixed(2))||\"--.--\",\" V\"]})]})]})]});}}]);return FieldMonitorStation;}(React.PureComponent);var FieldMonitor=/*#__PURE__*/function(_WebsocketComponent){_inherits(FieldMonitor,_WebsocketComponent);var _super2=_createSuper(FieldMonitor);function FieldMonitor(){var _this3;_classCallCheck(this,FieldMonitor);for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2];}_this3=_super2.call.apply(_super2,[this].concat(args));_this3.state={stations:[],mode:\"View\"};_this3.componentDidMount=function(){return _this3.handles=[_this3.listen(\"Arena/State/Current\",\"state\"),_this3.listen(\"Arena/Match/Current\",\"match\"),_this3.listen(\"Arena/Alliance/CurrentStations\",\"stations\"),_this3.listen(\"Resource/Requirements/Current\",\"resource_status\")];};_this3.renderAlliance=function(stations){return/*#__PURE__*/_jsx(React.Fragment,{children:stations.map(function(s){var _this3$state,_this3$state2;return/*#__PURE__*/_jsx(FieldMonitorStation,{mode:_this3.state.mode,state:(_this3$state=_this3.state)===null||_this3$state===void 0?void 0:_this3$state.state,match:(_this3$state2=_this3.state)===null||_this3$state2===void 0?void 0:_this3$state2.match,station:s,do_estop:function do_estop(){return _this3.send({Arena:{Alliance:{UpdateAlliance:{station:s.station,estop:true}}}});},new_ticket:function new_ticket(ticket){return _this3.send({Ticket:{Insert:ticket}});}});})});};_this3.renderFTAControls=function(){var mode=_this3.state.mode;var mode_btns=[{mode:\"View\",variant:\"success\",icon:faEye},{mode:\"Estop\",variant:\"estop\",icon:faBan},{mode:\"Flag\",variant:\"warning\",icon:faFlag},{mode:\"Resource\",variant:\"primary\",icon:faUsers}];return/*#__PURE__*/_jsx(React.Fragment,{children:/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{children:mode_btns.map(function(mb){return/*#__PURE__*/_jsx(Button,{variant:mode===mb.mode?\"secondary\":mb.variant,onClick:function onClick(){return _this3.setState({mode:mb.mode});},disabled:mode===mb.mode,children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:mb.icon})});})})})});};_this3.renderAvailable=function(){var _this3$state3=_this3.state,stations=_this3$state3.stations,mode=_this3$state3.mode,resource_status=_this3$state3.resource_status;return/*#__PURE__*/_jsxs(Row,{children:[_this3.props.fta?/*#__PURE__*/_jsx(Col,{className:\"col-full monitor-fta-controls\",children:_this3.renderFTAControls()}):undefined,/*#__PURE__*/_jsx(Col,{className:\"col-full\",children:mode===\"Resource\"&&resource_status!=null?/*#__PURE__*/_jsx(ResourceRequirementMinimap,{status:resource_status}):/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{className:\"col-full monitor-alliance\",\"data-alliance\":\"red\",children:_this3.renderAlliance(stations.filter(function(s){return s.station.alliance===\"red\";}))}),/*#__PURE__*/_jsx(Col,{className:\"col-full monitor-alliance\",\"data-alliance\":\"blue\",children:_this3.renderAlliance(stations.filter(function(s){return s.station.alliance===\"blue\";}).reverse())})]})})]});};return _this3;}_createClass(FieldMonitor,[{key:\"render\",value:function render(){var stations=this.state.stations;return/*#__PURE__*/_jsx(Col,{className:\"field-monitor col-full\",children:stations.length>0?this.renderAvailable():/*#__PURE__*/_jsx(\"h4\",{className:\"m-5\",children:\" Waiting... \"})});}}]);return FieldMonitor;}(WebsocketComponent);export{FieldMonitor as default};","map":{"version":3,"names":["faBan","faCode","faEye","faFlag","faNetworkWired","faRobot","faUsers","faWifi","FontAwesomeIcon","confirmBool","React","Button","Col","Row","withVal","WebsocketComponent","newTicket","ResourceRequirementMinimap","FieldMonitorStation","triggerEstop","station","props","station_text","alliance","toUpperCase","subtitle","team","t","size","okBtn","className","variant","children","cancelBtn","result","do_estop","flag","match","match_meta","new_ticket","lostPktPercent","lost","sent","renderSent","percent","toFixed","whatError","stn","report","estop","playing_match","state","bypass","occupancy","ds_eth","radio_ping","rio_ping","robot_ping","rtt","battery","pkts_lost","pkts_sent","mode","s","ds_report","astop","error","toString","padStart","PureComponent","FieldMonitor","stations","componentDidMount","handles","listen","renderAlliance","map","send","Arena","Alliance","UpdateAlliance","ticket","Ticket","Insert","renderFTAControls","mode_btns","icon","mb","setState","renderAvailable","resource_status","fta","undefined","filter","reverse","length"],"sources":["/home/spacey_sooty/Documents/projects/JMS/jms-frontend/src/monitor/FieldMonitor.tsx"],"sourcesContent":["import { faBan, faCircleArrowLeft, faCode, faEye, faFlag, faNetworkWired, faRobot, faStop, faUsers, faWifi, IconDefinition } from \"@fortawesome/free-solid-svg-icons\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport confirmBool, { confirmModal } from \"components/elements/Confirm\";\nimport EnumToggleGroup from \"components/elements/EnumToggleGroup\";\nimport React from \"react\";\nimport { Button, Col, Form, Row } from \"react-bootstrap\";\nimport { withVal } from \"support/util\";\nimport { WebsocketComponent } from \"support/ws-component\";\nimport { SerialisedAllianceStation, ArenaState, LoadedMatch, SupportTicket, ResourceRequirementStatus } from \"ws-schema\";\nimport update from \"immutability-helper\";\nimport BufferedFormControl from \"components/elements/BufferedFormControl\";\nimport moment from \"moment\";\nimport newTicket from \"csa/NewTicket\";\nimport { ResourceRequirementMinimap } from \"components/ResourceComponents\";\n\ntype FieldMonitorMode = \"View\" | \"Estop\" | \"Flag\" | \"Resource\";\n\ntype FieldMonitorStationState = {\n  station: SerialisedAllianceStation,\n  state?: ArenaState,\n  match?: LoadedMatch,\n  mode: FieldMonitorMode,\n  do_estop: () => void,\n  new_ticket: (ticket: SupportTicket) => void\n}\n\nclass FieldMonitorStation extends React.PureComponent<FieldMonitorStationState> {\n  triggerEstop = async () => {\n    const { station } = this.props;\n    const station_text = `${ station.station.alliance.toUpperCase() } ${ station.station.station }`;\n\n    const subtitle = <h2 className=\"estop-subtitle\">\n      Are you sure you want to <strong className=\"text-danger\">EMERGENCY STOP {station_text}{ withVal(station.team, t => ` (${t})`) }?</strong>\n    </h2>\n    let result = await confirmBool(subtitle, {\n      size: \"xl\",\n      okBtn: {\n        size: \"lg\",\n        className: \"estop-big\",\n        variant: \"estop\",\n        children: `E-STOP ${station_text} ${station.team || \"\"}`\n      },\n      cancelBtn: {\n        size: \"lg\",\n        className: \"btn-block\",\n        children: \"CANCEL\",\n        variant: \"secondary\"\n      }\n    });\n\n    if (result) {\n      this.props.do_estop();\n    }\n  }\n\n  flag = async (station: SerialisedAllianceStation) => {\n    newTicket(\"FTA\", station.team!, this.props.match!.match_meta, this.props.new_ticket);\n  }\n  \n  lostPktPercent = (lost: number, sent: number) => (lost) / ((lost + sent) || 1) * 100;\n\n  renderSent = (lost: number, sent: number) => {\n    let percent = 100 - this.lostPktPercent(lost, sent);\n\n    if (percent > 100)\n      return \"HI\";\n    else if (percent < 0)\n      return \"LO\";\n    return percent.toFixed(0);\n  }\n\n  whatError = (stn: SerialisedAllianceStation, report: SerialisedAllianceStation[\"ds_report\"], estop: boolean) => {\n    let playing_match = this.props.state?.state === \"MatchPlay\";\n\n    if (stn.bypass) return null;\n    if (estop) return \"E-STOPPED\";\n\n    if (stn.team === null) return \"NO TEAM\";\n    if (stn.occupancy == \"Vacant\") return stn.ds_eth ? \"ETH OK NO DS\" : \"NO DS\";\n    if (stn.occupancy == \"WrongMatch\") return \"WRONG MATCH\";\n    if (stn.occupancy == \"WrongStation\") return \"WRONG STATION\";\n\n    if (report == null) return \"NO DS REPORT\";\n\n    if (!report.radio_ping) return \"NO RADIO\";\n    if (!report.rio_ping) return \"NO RIO\";\n    if (!report.robot_ping) return \"NO CODE\";\n\n    if (report.rtt > 100) return \"HIGH LATENCY\";\n\n    if (report.battery < 9) return \"LOW BATTERY\";\n\n    if (playing_match && this.lostPktPercent(report.pkts_lost, report.pkts_sent) > 10)\n      return \"HIGH PACKET LOSS\";\n    \n    if (playing_match && report.mode === null)\n      return \"DISABLED\";\n\n    if (playing_match && report.mode !== this.props.match?.state)\n      return report.mode?.toUpperCase();\n\n    return null;\n  }\n\n  render() {\n    let s = this.props.station;\n    let report = s.ds_report;\n    let estop = report?.estop || s.estop || s.astop;\n\n    let error = this.whatError(s, report, estop);\n\n    return <Row className=\"monitor-station\" data-error={error} data-bypass={s.bypass} data-estop={estop}>\n      <Col className=\"monitor-station-id\" md=\"auto\">\n        { s.station.station }\n      </Col>\n      <Col className=\"monitor-data col-full\">\n        {\n          s.bypass ? <React.Fragment /> : \n            <Row className=\"monitor-data-header\">\n              <Col className=\"monitor-eth\" md=\"auto\" data-eth-ok={s.ds_eth}> <FontAwesomeIcon icon={faNetworkWired} /> </Col>\n              <Col className=\"monitor-occupancy\" data-occupancy={s.occupancy} />\n              <Col className=\"monitor-team\">\n                { s.team || \"\" }\n              </Col>\n              <Col className=\"text-end\" data-ok={ this.lostPktPercent(report?.pkts_lost || 0, report?.pkts_sent || 0) < 10 }>\n                { this.renderSent(s.ds_report?.pkts_lost || 0, s.ds_report?.pkts_sent || 0) }%\n              </Col>\n            </Row>\n        }\n        <Row className=\"monitor-jumbo align-items-center\" data-error={error}>\n          <Col>\n            {\n              s.bypass ? `BYPASS ${s.team || \"\"}`\n                : (s.team && this.props.mode === \"Flag\") ?\n                  <Button\n                    className=\"btn-block monitor-team-btn\"\n                    variant=\"orange\"\n                    onClick={() => this.flag(s)}\n                  >\n                    FLAG ISSUE FOR CSA\n                  </Button>\n                : s.estop ? \"E-STOPPED\"\n                : this.props.mode === \"Estop\" ?\n                  <Button\n                    className=\"btn-block monitor-team-btn\"\n                    variant=\"estop\"\n                    onClick={this.triggerEstop}\n                  > E-STOP { s.team || \"\" } </Button>\n                : error ? error\n                : (report?.mode?.toUpperCase() || \"READY\")\n            }\n          </Col>\n        </Row>\n        {\n          s.bypass ? <React.Fragment /> : \n            <Row className=\"monitor-indicators\">\n              <Col data-ok={s.ds_report?.radio_ping} md=\"4\">\n                <FontAwesomeIcon icon={faWifi} /> &nbsp;\n                { (s.ds_report?.rtt?.toString() || \"---\").padStart(3, \"\\u00A0\") }ms\n              </Col>\n              <Col data-ok={s.ds_report?.rio_ping}>\n                <FontAwesomeIcon icon={faRobot} size=\"lg\"/>\n              </Col>\n              <Col data-ok={s.ds_report?.robot_ping}>\n                <FontAwesomeIcon icon={faCode} size=\"lg\"/>\n              </Col>\n              <Col data-ok={s.ds_report?.battery ? s.ds_report.battery > 9 : \"\"} md=\"auto\">\n                {/* <FontAwesomeIcon icon={faCarBattery} size=\"lg\"/> &nbsp; */}\n                { s.ds_report?.battery?.toFixed(2) || \"--.--\" } V\n              </Col>\n            </Row>\n        }\n      </Col>\n    </Row>\n  }\n}\n\ntype FieldMonitorState = {\n  stations: SerialisedAllianceStation[],\n  state?: ArenaState,\n  match?: LoadedMatch,\n  resource_status?: ResourceRequirementStatus,\n  mode: FieldMonitorMode\n};\n\nexport default class FieldMonitor extends WebsocketComponent<{ fta: boolean }, FieldMonitorState> {\n  readonly state: FieldMonitorState = {\n    stations: [],\n    mode: \"View\"\n  };\n\n  componentDidMount = () => this.handles = [\n    this.listen(\"Arena/State/Current\", \"state\"),\n    this.listen(\"Arena/Match/Current\", \"match\"),\n    this.listen(\"Arena/Alliance/CurrentStations\", \"stations\"),\n    this.listen(\"Resource/Requirements/Current\", \"resource_status\")\n  ];\n\n  renderAlliance = (stations: SerialisedAllianceStation[]) => {\n    return <React.Fragment>\n      {\n        stations.map(s => (\n          <FieldMonitorStation\n            mode={this.state.mode}\n            state={this.state?.state}\n            match={this.state?.match}\n            station={s}\n            do_estop={() => this.send({\n              Arena: { Alliance: { UpdateAlliance: { station: s.station, estop: true } } }\n            })}\n            new_ticket={ticket => this.send({\n              Ticket: { Insert: ticket }\n            })}\n          />\n        ))\n      }\n    </React.Fragment>\n  }\n\n  renderFTAControls = () => {\n    const { mode } = this.state;\n    const mode_btns: { mode: FieldMonitorMode, variant: string, icon: IconDefinition }[] = [\n      { mode: \"View\", variant: \"success\", icon: faEye },\n      { mode: \"Estop\", variant: \"estop\", icon: faBan },\n      { mode: \"Flag\", variant: \"warning\", icon: faFlag },\n      { mode: \"Resource\", variant: \"primary\", icon: faUsers }\n    ];\n\n    return <React.Fragment>\n      <Row>\n        <Col>\n          {\n            mode_btns.map(mb => (\n              <Button\n                variant={ mode === mb.mode ? \"secondary\" : mb.variant }\n                onClick={() => this.setState({ mode: mb.mode })}\n                disabled={mode === mb.mode}\n              >\n                <FontAwesomeIcon icon={mb.icon} />\n              </Button>\n            ))\n          }\n        </Col>\n      </Row>\n    </React.Fragment>\n  }\n\n  renderAvailable = () => {\n    const { stations, mode, resource_status } = this.state;\n    return <Row>\n      {\n        this.props.fta ? \n          <Col className=\"col-full monitor-fta-controls\">\n            { this.renderFTAControls() }\n          </Col> : undefined\n      }\n      <Col className=\"col-full\">\n        {\n          mode === \"Resource\" && resource_status != null ?\n            <ResourceRequirementMinimap status={resource_status} />\n            : <Row>\n                <Col className=\"col-full monitor-alliance\" data-alliance=\"red\">\n                  { this.renderAlliance( stations.filter(s => s.station.alliance === \"red\") ) }\n                </Col>\n                <Col className=\"col-full monitor-alliance\" data-alliance=\"blue\">\n                  { this.renderAlliance( stations.filter(s => s.station.alliance === \"blue\").reverse() ) }\n                </Col>\n              </Row>\n            \n        }\n      </Col>\n\n    </Row>\n  }\n\n  render() {\n    const { stations } = this.state;\n    return <Col className=\"field-monitor col-full\">\n      {\n        stations.length > 0 ? this.renderAvailable() : <h4 className=\"m-5\"> Waiting... </h4>\n      }\n    </Col>\n  }\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}